"use strict";(self.webpackChunkascii_ui=self.webpackChunkascii_ui||[]).push([[8478],{7319:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>u,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"hooks/use-effect","title":"useEffect","description":"Run side effects inside ascii-ui components.","source":"@site/docs/hooks/use_effect.md","sourceDirName":"hooks","slug":"/hooks/use-effect","permalink":"/ascii-ui-docs/docs/hooks/use-effect","draft":false,"unlisted":false,"editUrl":"https://github.com/rcasia/ascii-ui-docs/edit/main/docs/hooks/use_effect.md","tags":[{"inline":true,"label":"api","permalink":"/ascii-ui-docs/docs/tags/api"},{"inline":true,"label":"hooks","permalink":"/ascii-ui-docs/docs/tags/hooks"},{"inline":true,"label":"effect","permalink":"/ascii-ui-docs/docs/tags/effect"}],"version":"current","frontMatter":{"id":"use-effect","title":"useEffect","sidebar_label":"useEffect","description":"Run side effects inside ascii-ui components.","tags":["api","hooks","effect"]},"sidebar":"tutorialSidebar","previous":{"title":"Hooks in ascii-ui.nvim","permalink":"/ascii-ui-docs/docs/hooks/"},"next":{"title":"useFunctionRegistry [experimental]","permalink":"/ascii-ui-docs/docs/hooks/use-function-registry"}}');var r=t(4848),c=t(8453);const i={id:"use-effect",title:"useEffect",sidebar_label:"useEffect",description:"Run side effects inside ascii-ui components.",tags:["api","hooks","effect"]},o="useEffect",l={},d=[{value:"Reference",id:"reference",level:2},{value:"<code>useEffect(effect_fn, dependencies?)</code>",id:"useeffecteffect_fn-dependencies",level:3},{value:"Parameters",id:"parameters",level:3},{value:"Returns",id:"returns",level:3},{value:"Usage",id:"usage",level:2},{value:"Example: Run When Value Changes",id:"example-run-when-value-changes",level:3},{value:"Example: Run on Every Render",id:"example-run-on-every-render",level:3},{value:"Example: Cleanup Function",id:"example-cleanup-function",level:3}];function a(e){const n={br:"br",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"useeffect",children:"useEffect"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useEffect"})," lets you run a ",(0,r.jsx)(n.strong,{children:"side effect"})," after a component renders, and when specific observed values change."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"ui.hooks.useEffect(effect_fn, dependencies)\n"})}),"\n",(0,r.jsx)(n.h2,{id:"reference",children:"Reference"}),"\n",(0,r.jsx)(n.h3,{id:"useeffecteffect_fn-dependencies",children:(0,r.jsx)(n.code,{children:"useEffect(effect_fn, dependencies?)"})}),"\n",(0,r.jsxs)(n.p,{children:["Call ",(0,r.jsx)(n.code,{children:"useEffect"})," at the top level of a component to perform side effects like logging, timers, or subscriptions."]}),"\n",(0,r.jsxs)(n.p,{children:["If you provide ",(0,r.jsx)(n.strong,{children:"dependencies"}),", the effect will re-run only when those values change.",(0,r.jsx)(n.br,{}),"\n","If you omit them, the effect runs after ",(0,r.jsx)(n.strong,{children:"every render"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:"ui.hooks.useEffect(function()\n  -- side effect\n  return function()\n    -- optional cleanup\n  end\nend, { dep1, dep2 })\n"})}),"\n",(0,r.jsx)(n.h3,{id:"parameters",children:"Parameters"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Name"}),(0,r.jsx)(n.th,{children:"Type"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"effect_fn"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"fun(): (fun() | nil)"})}),(0,r.jsxs)(n.td,{children:["The callback function to run as a side effect. It executes after the component renders. Optionally, it can return a ",(0,r.jsx)(n.strong,{children:"cleanup function"})," that runs before the next effect or when the component unmounts."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"dependencies?"})}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"any[]"})}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.em,{children:"(Optional)"})," A table of ",(0,r.jsx)(n.strong,{children:"observed values"}),". The effect re-runs only when one of these values changes. If omitted, the effect runs after ",(0,r.jsx)(n.strong,{children:"every render"}),". If you pass an empty table ",(0,r.jsx)(n.code,{children:"{}"}),", it runs only ",(0,r.jsx)(n.strong,{children:"once on mount"}),"."]})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"returns",children:"Returns"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"useEffect"})," does not return a value."]}),"\n",(0,r.jsxs)(n.p,{children:["Its purpose is to register a ",(0,r.jsx)(n.strong,{children:"side effect"})," and manage ",(0,r.jsx)(n.strong,{children:"cleanup logic"})," tied to the component\u2019s lifecycle.",(0,r.jsx)(n.br,{}),"\n","If the ",(0,r.jsx)(n.code,{children:"effect_fn"})," returns a function, that function will be called as a ",(0,r.jsx)(n.strong,{children:"cleanup"})," before the next effect runs or when the component unmounts."]}),"\n",(0,r.jsx)(n.hr,{}),"\n",(0,r.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,r.jsx)(n.h3,{id:"example-run-when-value-changes",children:"Example: Run When Value Changes"}),"\n",(0,r.jsxs)(n.p,{children:["Provide dependencies so the effect runs ",(0,r.jsx)(n.strong,{children:"only"})," when they change:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'useEffect(function()\n  print("Count changed to", count)\nend, { count })\n'})}),"\n",(0,r.jsx)(n.h3,{id:"example-run-on-every-render",children:"Example: Run on Every Render"}),"\n",(0,r.jsxs)(n.p,{children:["Call ",(0,r.jsx)(n.code,{children:"useEffect"})," without dependencies to run the effect after ",(0,r.jsx)(n.strong,{children:"every render"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'local ui = require("ascii-ui")\nlocal useState = ui.hooks.useState\nlocal useEffect = ui.hooks.useEffect\nlocal Paragraph = ui.components.Paragraph\nlocal Button = ui.components.Button\n\n--- @return string\nlocal current_time = function()\n\treturn tostring(os.date("%H:%M:%S"))\nend\n\nlocal MyComponent = ui.createComponent("MyComponent", function()\n\tlocal count, setCount = useState(0)\n\n\tuseEffect(function()\n\t\tprint("Rendered at " .. current_time())\n\n\t\treturn function()\n\t\t\tprint("Deleted at " .. current_time())\n\t\tend\n\tend)\n\n\treturn {\n\t\tParagraph({ content = "Count: " .. count }),\n\t\tButton({\n\t\t\tlabel = "Increment",\n\t\t\ton_press = function()\n\t\t\t\tsetCount(count + 1)\n\t\t\tend,\n\t\t}),\n\t}\nend)\n\n\nreturn MyComponent\n'})}),"\n",(0,r.jsx)(n.p,{children:"Every time the component re-renders, the effect runs again."}),"\n",(0,r.jsx)(n.h3,{id:"example-cleanup-function",children:"Example: Cleanup Function"}),"\n",(0,r.jsx)(n.p,{children:"Return a function from the effect to clean up resources when the component unmounts or before the next run:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-lua",children:'useEffect(function()\n  local timer = vim.loop.new_timer()\n  timer:start(1000, 1000, function()\n    print("Tick!")\n  end)\n\n  return function()\n    timer:stop()\n    timer:close()\n    print("Timer stopped")\n  end\nend, {})\n'})}),"\n",(0,r.jsx)(n.p,{children:"This cleanup function is useful for timers, subscriptions, or event listeners, ensuring they are properly released when the component unmounts."})]})}function u(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(a,{...e})}):a(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>o});var s=t(6540);const r={},c=s.createContext(r);function i(e){const n=s.useContext(c);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);